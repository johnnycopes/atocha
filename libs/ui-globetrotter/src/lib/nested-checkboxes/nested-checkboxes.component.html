<ui-tree
  [node]="item"
  [getId]="treeProvider.getId"
  [getChildren]="treeProvider.getChildren"
  [template]="checkbox"
></ui-tree>

<ng-template #checkbox
  let-item
  let-level="level"
  let-parent="level > 0"
>
  <ui-checkbox class="checkbox"
    [style.margin-left.px]="level * 24"
    [invertColors]="!parent && invertedRootCheckbox"
    [ngModel]="states[this.treeProvider.getId(item)]"
    (ngModelChange)="onChange($event, item)"
  >
    <ng-container
      [ngTemplateOutlet]="itemTemplate ? itemTemplate : defaultTemplate"
      [ngTemplateOutletContext]="{
        $implicit: item,
        parent: parent
      }"
    ></ng-container>
  </ui-checkbox>
</ng-template>

<ng-template #defaultTemplate
  let-item
>
  {{ this.treeProvider.getId(item) }}
</ng-template>
