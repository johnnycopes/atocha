<ui-small-caps header="Places">
  <div class="regions">
    <core-counted-checkbox-tree-new *ngIf="tree"
      class="places"
      [item]="tree"
      [getId]="getId"
      [getChildren]="getChildren"
      [getLeafItemCount]="getNumberOfCountries"
      [indentation]="0"
      [treeTemplate]="image"
      [itemTemplate]="label"
      size="large"
      [ngModel]="places"
      (ngModelChange)="onPlacesChange($event)"
    ></core-counted-checkbox-tree-new>
  </div>
</ui-small-caps>

<ng-template
  #image
  let-item
  let-level="level"
  let-selected="selected"
  let-total="total"
>
  <ui-icon *ngIf="level === 1"
    class="image"
    [icon]="getId(item)"
    [highlighted]="!!selected"
  ></ui-icon>
</ng-template>

<ng-template
  #label
  let-item
  let-level="level"
  let-selected="selected"
  let-total="total"
>
  <ng-container [ngSwitch]="level">
    <div *ngSwitchCase="0"
      class="top"
    >
      <div class="top__counter">
        <span class="bold">
          {{ selected }} / {{ total }}
        </span>
        possible countries in the cards.
      </div>

      <div class="top__buttons">
        <button core-button="secondary"
          class="top__select-all"
          (click)="onSelectAll()"
        >
          Select all
        </button>
        <button core-button="secondary"
          class="top__clear-all"
          (click)="onClearAll()"
        >
          Clear all
        </button>
      </div>
    </div>

    <span *ngSwitchCase="1"
      class="bold"
    >
      {{ getId(item) }} ({{ selected }} / {{ total }})
    </span>

    <span *ngSwitchCase="2">
      {{ getId(item) }} ({{ total }})
    </span>
  </ng-container>
</ng-template>
