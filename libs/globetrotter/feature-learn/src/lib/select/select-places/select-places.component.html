<ui-small-caps header="Places">
  <div class="top">
    <div class="top__counter">
      <span class="bold">
        {{ overallSelected }} / {{ overallTotal }}
      </span>
      possible countries in the cards.
    </div>
    <div class="top__buttons">
      <ui-button class="top__select-all"
        buttonStyle="secondary"
        buttonText="Select all"
        (click)="onSelectAll()"
      ></ui-button>
      <ui-button class="top__clear-all"
        buttonStyle="secondary"
        buttonText="Clear all"
        (click)="onClearAll()"
      ></ui-button>
    </div>
  </div>
  <div class="regions">
    <div class="region"
      *ngFor="let regionState of regionStates"
      >
      <ui-icon class="region__image"
        [icon]="regionState.region.name"
        [highlighted]="!!regionState.selected"
      ></ui-icon>
      <core-nested-checkboxes-with-counts class="region__checkboxes"
        [item]="regionState.region"
        [getId]="getId"
        [getChildren]="getChildren"
        [getLeafItemCount]="getNumberOfCountries"
        [itemTemplate]="label"
        [ngModel]="state"
        (ngModelChange)="onStateChange($event)"
        (selectedChange)="onSelectedChange(regionState, $event)"
        (totalChange)="onTotalChange(regionState, $event)"
      ></core-nested-checkboxes-with-counts>

      <ng-template
        #label
        let-item
        let-parent="parent"
        let-selected="selected"
        let-total="total"
      >
        <span class="bold"
          *ngIf="!parent; else child"
        >
          {{ getId(item) }} ({{ selected }} / {{ total }})
        </span>
        <ng-template #child>
          <span>
            {{ getId(item) }} ({{ total }})
          </span>
        </ng-template>
      </ng-template>
    </div>
  </div>
</ui-small-caps>
