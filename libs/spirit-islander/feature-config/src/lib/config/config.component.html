<main ui-page>
  <!-- <ng-container ui-page-content>
    {{ form.value | json }}
  </ng-container> -->
  <form *ngIf="config"
    class="config"
    ui-page-content
    [formGroup]="form"
    (ngSubmit)="onSubmit()"
  >
    <ui-card-group
      name="You"
      description="What are you playing with?"
    >
      <ui-card name="expansions">
        <ui-checkbox-tree
          [tree]="expansionsTree"
          [form]="form"
          controlName="expansions"
          (nodeClick)="onExpansionChange($event)"
          ></ui-checkbox-tree>
      </ui-card>

      <ui-card name="players"
        [error]="form.errors?.['playersOutnumberTotalBoards']"
      >
        <h3 ui-card-header>
          Players
        </h3>
        <app-select-players [form]="form">
        </app-select-players>
      </ui-card>

      <ui-card name="difficulty"
        [error]="form.errors?.['invalidDifficultyRange']"
      >
        <h3 ui-card-header>
          Difficulty
        </h3>
        <app-select-difficulty-range [form]="form">
        </app-select-difficulty-range>
      </ui-card>
    </ui-card-group>

    <ui-card-group
      name="The Game"
      description="What are you open to playing with?"
    >
      <ui-card name="spirits"
        [error]="form.errors?.['playersOutnumberSpirits']"
      >
        <ui-checkbox-tree
          [tree]="spiritsTree"
          [form]="form"
          controlName="spiritNames"
        ></ui-checkbox-tree>
      </ui-card>

      <ui-card name="maps"
        [error]="form.get('mapNames')?.errors?.['required']"
      >
        <ui-checkbox-tree
          [tree]="mapsTree"
          [form]="form"
          controlName="mapNames"
        ></ui-checkbox-tree>
      </ui-card>

      <ui-card name="boards"
        [error]="form.errors?.['playersOutnumberSelectedBoards']"
      >
        <ui-checkbox-tree
          [tree]="boardsTree"
          [form]="form"
          controlName="boardNames"
        ></ui-checkbox-tree>
      </ui-card>

      <ui-card name="scenarios"
        [error]="form.get('scenarioNames')?.errors?.['required']"
      >
        <ui-checkbox-tree
          [tree]="scenariosTree"
          [form]="form"
          controlName="scenarioNames"
        ></ui-checkbox-tree>
      </ui-card>

      <ui-card name="adversaries"
        [error]="form.get('adversaryNamesAndIds')?.errors?.['required']"
      >
        <ui-checkbox-tree
          [tree]="adversariesTree"
          [form]="form"
          controlName="adversaryNamesAndIds"
        ></ui-checkbox-tree>
      </ui-card>
    </ui-card-group>

    <div ui-page-actions>
      <button core-button
        [disabled]="!form.valid"
      >
        Generate
      </button>
    </div>
  </form>
</main>
